<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="DESCRIPTION META TAG">
  <meta property="og:title" content="SOCIAL MEDIA TITLE TAG"/>
  <meta property="og:description" content="SOCIAL MEDIA DESCRIPTION TAG TAG"/>
  <meta property="og:url" content="URL OF THE WEBSITE"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="image/your_banner_image.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>


  <meta name="twitter:title" content="TWITTER BANNER TITLE META TAG">
  <meta name="twitter:description" content="TWITTER BANNER DESCRIPTION META TAG">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <!-- <meta name="twitter:image" content="images/your_twitter_banner_image.png"> -->
  <meta name="twitter:card" content="summary_large_image">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="KEYWORDS SHOULD BE PLACED HERE">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title>AnydoorMed: Reference-Guided Anomaly Inpainting for Medical Counterfactuals</title>
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="css/bulma.min.css">
  <link rel="stylesheet" href="css/bulma-carousel.min.css">
  <link rel="stylesheet" href="css/bulma-slider.min.css">
  <link rel="stylesheet" href="css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="js/fontawesome.all.min.js"></script>
  <script src="js/bulma-carousel.min.js"></script>
  <script src="js/bulma-slider.min.js"></script>
  <script src="js/index.js"></script>
</head>

<body>
  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title"><i>AnydoorMed:</i> Reference-Guided Anomaly Inpainting for Medical Counterfactuals</h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://alexbubu.com/" target="_blank">Alexandru Buburuzan</a>, &nbsp;
              </span>supervised by
                    <span class="author-block">
                      <a href="https://scholar.google.com/citations?user=zhlk0OsAAAAJ&hl=en" target="_blank">Prof. Tim Cootes</a>
                    </span>
                  </div>

                  <div class="is-size-5 publication-authors">
                    <span class="author-block">
                        The University of Manchester
                      <br>Completed in fulfilment of <i>"Reference-Guided Diffusion Inpainting For Multimodal Counterfactual Generation"</i>
                  </div>

                  <div class="column has-text-centered">
                    <div class="publication-links">

                  <span class="link-block">
                      <a href="https://arxiv.org/pdf/2507.23058" target="_blank"
                      class="external-link button is-normal is-rounded is-outlined">
                      <span class="icon">
                        <i class="ai ai-arxiv"></i>
                      </span>
                      <span>arXiv</span>
                    </a>
                  </span>

                  <!-- Github link -->
                  <span class="link-block">
                    <a href="https://github.com/alexbuburuzan/anydoormed" target="_blank"
                    class="external-link button is-normal is-rounded is-outlined">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>GitHub</span>
                  </a>
                </span>

                <!-- ArXiv abstract Link -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Teaser image-->
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img src="anydoormed/anydoormed_teaser.jpg" alt="AnydoorMed Teaser" style="width: 100%; height: auto; display: block; margin: 0 auto; border-radius: 0rem;">
      <h2 class="subtitle has-text-centered">
        Given a source image containing an anomaly and a target location within a possibly healthy scan, AnydoorMed can synthesise a new lesion that retains the visual and structural characteristics of the reference while blending it semantically with the surrounding tissue in the target context
      </h2>
    </div>
  </div>
</section>
<!-- End teaser image -->

<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            High-fidelity data is essential for developing reliable computer-aided diagnostics in medical imaging, yet clinical datasets are difficult to obtain and often suffer from severe class imbalance, particularly for rare pathologies such as malignant breast lesions. Synthetic data offers a promising avenue to mitigate these limitations by augmenting existing datasets with diverse and realistic counterfactual examples. To be clinically useful, generated data must respect anatomical constraints, preserve fine-grained tissue structures, and allow controlled insertion of abnormalities. While recent diffusion-based methods enable anomaly synthesis via text or segmentation masks, such conditioning often fails to capture subtle structural variations. In contrast, <i>diffusion inpainting has shown promising results on natural images but remains underexplored in medical imaging</i>. This works proposes AnydoorMed, a reference-guided inpainting method for mammography that transfers lesion characteristics from a source scan to a target location, blending them seamlessly with surrounding tissue, supporting the generation of realistic counterfactual examples.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->

<!-- Architecture section -->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <h2 class="title is-2">Architecture</h2>
       <div class="item">
        <!-- Your image here -->
        <div class="item" style="margin-top: 3rem; margin-top: 3rem;">
          <img src="anydoormed/architecture_figure.jpg" alt="AnydoorMed Architecture" style="width: 100%; height: auto; display: block; margin: 0 auto; border-radius: 0.5rem;"/>
          <h2 class="subtitle has-text-centered">
            This work adapts <a href="https://arxiv.org/abs/2307.09481" target="_blank">AnyDoor</a>, a reference-based image inpainting method, to the medical domain. Additional input and output adaption layers were added to the variational autoencoder of StableDiffusion and finetuned on mammography scans from <a href="https://www.nature.com/articles/s41597-023-02100-7" target="_blank">VinDr-Mammo</a>. Gated cross-attention layers added within the pre-trained diffusion inpainting model were trained in a separate stage, with the medical autoencoder frozen. The anomaly's High Frequency map (HF map) was coloured purple for visualisation purposes only.
          </h2>
        </div>
      </div>
</div>
</div>
</section>
<!-- End architecture section -->

<!-- Results section -->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <h2 class="title is-2">Results</h2>
    
      
          <div class="item" style="margin-bottom: 3rem; margin-top: 3rem;">
            <img src="anydoormed/insertion.jpg" alt="AnydoorMed insertion results" class="full-width-image" style="max-height: 80vh; object-fit: contain;"/>
            <h2 class="subtitle has-text-centered">
             Anomaly <strong>insertion</strong> results. AnydoorMed inserts the reference anomaly (second column), guided by the context and high-frequency map context (first column), into the healthy mammography scan (fourth column), producing the composited result (third column). The inpainted anomalies preserve some of the features present in the reference image, such as calcifications (first row). For all examples, the anomaly was composited semantically in the destination scan, within the breast tissue.
          </h2>
          </div>
          <hr>

          <div class="item" style="margin-bottom: 3rem; margin-top: 3rem;">
            <img src="anydoormed/replacement.jpg" alt="AnydoorMed replacement results" class="full-width-image" style="max-height: 80vh; object-fit: contain;"/>
           <h2 class="subtitle has-text-centered">
              Anomaly <strong>replacement</strong> results. AnydoorMed replaces the anomaly from the original scan (fourth column), with the reference anomaly (second column), guided by the context and high-frequency map context (first column), producing the composited result (third column). This is done by removing the anomaly from the scan and using a similarly-sized reference as a condition. The inpainted anomalies preserve some of the features present in the reference image, such as the “excavation” from the first row. All generated scans look highly realistic, with anomalies being semantically blended within the breast tissue.
          </h2>
          </div>
          <hr>

       <!-- Main results image -->
      <div class="item" style="margin-top: 3rem; margin-top: 3rem;">
        <div style="text-align: center;">
          <img src="anydoormed/results.jpg" alt="AnydoorMed Results" style="width: 100%; max-width: 90%; height: auto; max-height: 60vh; object-fit: contain; display: block; margin: 0 auto; border-radius: 0rem;"/>
          <h2 class="subtitle has-text-centered" style="margin-top: 1.5rem;">
            AnydoorMed results on the test set of VinDr-Mammo dataset according to image realism metrics.
          </h2>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End results section -->

<!-- Discussion section -->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <h2 class="title is-2">Discussion</h2>
      <div class="item">
        <div class="item" style="margin-bottom: 3rem; margin-top: 3rem;">
          <img src="anydoormed/failure.jpg" alt="Open World" style="width: 100%; max-width: 90%; height: auto; max-height: 60vh; object-fit: contain; display: block; margin: 0 auto; border-radius: 0rem;"/>
          <h2 class="subtitle has-text-centered" style="margin-top: 1.5rem;">
            These examples illustrate some failure cases of AnydoorMed. From top to bottom: the inserted anomaly does not closely replicate the microcalcifications from the reference image (which may be undesirable in certain scenarios); the inpainting produces an anatomically implausible result due to the bounding box being placed primarily outside the breast tissue; and finally, the last example exhibits visible copy-and-paste artefacts.
          </h2>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End discussion section -->


<!--BibTex citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>
        @article{buburuzan2025reference,
          title={Reference-Guided Diffusion Inpainting For Multimodal Counterfactual Generation},
          author={Buburuzan, Alexandru},
          journal={arXiv preprint arXiv:2507.23058},
          year={2025}
        }
      </code></pre>
    </div>
</section>
<!--End BibTex citation -->

<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a>, adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
            <br> This license only applies to the website. Please check the official repository of this work for details on the terms and conditions that apply to the model and code.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Add custom styles for image sizing -->
<style>
  .full-width-image {
    width: 100%;
    max-width: 90%;
    height: auto;
    display: block;
    margin: 0 auto;
    border-radius: 0;
  }
  
  body {
    font-family: "Palatino Linotype", "Palatino", "Times New Roman", serif !important;
    line-height: 1.6 !important;
    color: #333 !important;
  }
  
  h1, h2, h3, h4, h5, h6 {
    font-family: "Palatino Linotype", "Palatino", "Times New Roman", serif !important;
    font-weight: 400 !important;
    color: #2c3e50 !important;
  }
  
  .publication-authors {
    font-family: "Palatino Linotype", "Palatino", "Times New Roman", serif !important;
  }
  
  .title {
    font-weight: 400 !important;
    text-align: center !important;
  }
  
  .subtitle {
    font-weight: 400 !important;
    color: #555 !important;
  }
  
  .content p {
    margin-bottom: 1.2em !important;
    text-align: justify !important;
    font-size: 1rem !important;
  }
  
  .hero {
    padding: 2rem 0 !important;
  }
  
  .hero.is-small {
    padding: 1.5rem 0 !important;
  }
  
  /* Custom spacing for teaser video section */
  .hero.teaser {
    margin-top: -4rem !important;
    margin-bottom: -2rem !important;
  }
  
  .hero.teaser .subtitle {
    margin-top: 1.5rem !important;
    margin-bottom: 1rem !important;
  }
  
  /* Subtle borders and backgrounds */
  .hero.is-light {
    background-color: #fafafa !important;
    border-top: 1px solid #eee !important;
    border-bottom: 1px solid #eee !important;
  }
  
  /* Cleaner buttons */
  .button.is-outlined {
    border-color: #666 !important;
    color: #666 !important;
    transition: all 0.1s ease !important;
    border-radius: 0.5rem !important;
  }
  
  .button.is-outlined:hover {
    background-color: #666 !important;
    color: white !important;
  }
  
  /* Add more space between images and captions */
  .carousel-image, .full-width-image {
    margin-bottom: 1.5rem !important;
  }
  
  /* Fix carousel dot overlap with captions */
  .results-carousel {
    margin-bottom: 2rem !important;
  }
  
  .subtitle {
    margin-bottom: 1.5rem !important;
    text-align: center !important;
    max-width: 90% !important;
    margin-left: auto !important;
    margin-right: auto !important;
    font-size: 1.2rem !important;
  }
  
  /* Make images in grid have same height */
  .columns .column .full-width-image {
    height: 25rem !important;
    object-fit: contain !important;
  }
  
  /* Box container for image and description */
  .image-box {
    border: 1px solid #000 !important;
    border-radius: 0.5rem !important;
    padding: 1rem !important;
    margin-bottom: 2rem !important;
    background-color: #fff !important;
    height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    width: 90% !important;
    margin-left: auto !important;
    margin-right: auto !important;
  }
  
  /* Ensure carousel items display properly */
  .carousel .item {
    display: block !important;
  }
  
  /* Better PDF embedding */
  .pdf-container {
    width: 100% !important;
    height: 70vh !important;
    min-height: 400px !important;
    position: relative !important;
    border-radius: 0.5rem !important;
    overflow: hidden !important;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1) !important;
  }
  
  .responsive-pdf {
    width: 100% !important;
    height: 100% !important;
    border: none !important;
  }
  
  .pdf-fallback {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    height: 100% !important;
    background-color: #f8f9fa !important;
    text-align: center !important;
    padding: 2rem !important;
  }
  
  @media screen and (max-width: 768px) {
    .pdf-container {
      height: 55vh !important;
      min-height: 250px !important;
    }
  }
  
  @media screen and (max-width: 480px) {
    .pdf-container {
      height: 50vh !important;
      min-height: 200px !important;
    }
  }
  
  @media screen and (max-width: 360px) {
    .pdf-container {
      height: 45vh !important;
      min-height: 180px !important;
    }
  }
  
  /* Ensure abstract section has proper mobile padding */
  .section.hero.is-light {
    padding-left: 1.5rem !important;
    padding-right: 1.5rem !important;
  }
  
  @media screen and (max-width: 768px) {
    .section.hero.is-light {
      padding-left: 1rem !important;
      padding-right: 1rem !important;
    }
  }
  

</style>

<!-- Default Statcounter code for MObI https://alexbubu.com/mobi -->
<script type="text/javascript">
  var sc_project=13119078; 
  var sc_invisible=1; 
  var sc_security="af6eeb3b"; 
  </script>
  <script type="text/javascript"
  src="https://www.statcounter.com/counter/counter.js" async></script>
  <noscript><div class="statcounter"><a title="Web Analytics"
  href="https://statcounter.com/" target="_blank"><img class="statcounter"
  src="https://c.statcounter.com/13119078/0/af6eeb3b/1/" alt="Web Analytics"
  referrerPolicy="no-referrer-when-downgrade"></a></div></noscript>
<!-- End of Statcounter Code -->

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Initialize carousels with autoplay disabled
    bulmaCarousel.attach('#results-carousel', {
      autoplay: false
    });
    
    bulmaCarousel.attach('#motivation-carousel', {
      autoplay: false
    });
    
    // If the carousels are already initialized elsewhere, try to stop them
    var resultsCarousel = document.querySelector('#results-carousel');
    var motivationCarousel = document.querySelector('#motivation-carousel');
    
    if (resultsCarousel && resultsCarousel.bulmaCarousel) {
      resultsCarousel.bulmaCarousel.stop();
    }
    
    if (motivationCarousel && motivationCarousel.bulmaCarousel) {
      motivationCarousel.bulmaCarousel.stop();
    }
  });
</script>

</body>
</html>
